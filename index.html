<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renault Captur 2025 - Konfigurator Systemowy</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700;900&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            --r-yellow: #FFCC33;
            --r-black: #000000;
            --r-white: #ffffff;
            --r-gray: #f9f9f9;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html { height: 100%; overflow: hidden; font-family: 'Montserrat', sans-serif; background: var(--r-white); }

        /* --- BLOKADA COOKIES & PRZYCISKU --- */
        #cookie-overlay {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 140px;
            background: rgba(0,0,0,0.95); color: white; z-index: 9999;
            display: flex; align-items: center; justify-content: center;
            border-top: 5px solid var(--r-yellow); transition: 0.5s;
        }

        .nav-lock-container { position: relative; width: 70%; }
        .lock-shield {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; cursor: not-allowed; display: flex;
            align-items: center; justify-content: center;
            background: rgba(255,255,255,0.1); border-radius: 5px; opacity: 0;
        }
        .lock-shield:hover { opacity: 1; background: rgba(200,0,0,0.8); }
        .lock-shield:hover::after { content: "PROSZĘ ZAAKCEPTOWAĆ COOKIES"; color: white; font-weight: 700; font-size: 0.7rem; }

        /* --- MODAL STARTOWY --- */
        #start-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--r-black); z-index: 10000; display: flex; align-items: center; justify-content: center;
        }
        .modal-box { background: white; padding: 40px; width: 500px; border-radius: 4px; }

        /* --- LAYOUT --- */
        header {
            height: 80px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 5%; border-bottom: 1px solid #eee; background: white;
        }
        main { display: grid; grid-template-columns: 1fr 500px; height: calc(100% - 80px); }
        .preview { background: var(--r-gray); display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .panel { padding: 40px; overflow-y: auto; border-left: 1px solid #eee; padding-bottom: 200px; }

        /* --- FORMULARZ --- */
        .equip-box { margin-bottom: 25px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
        .equip-box h3 { font-size: 0.8rem; background: #000; color: #FFCC33; padding: 5px 10px; margin-bottom: 10px; }
        .item { display: flex; align-items: center; margin-bottom: 8px; font-size: 0.8rem; cursor: pointer; }
        .item input { margin-right: 10px; accent-color: var(--r-yellow); }

        .btn { 
            background: var(--r-black); color: white; padding: 15px; width: 100%; 
            border: none; font-weight: 700; cursor: pointer; text-transform: uppercase;
        }
        .btn:disabled { background: #555; cursor: not-allowed; }

        /* --- FAKTURA --- */
        #invoice-view {
            background: white; padding: 40px; font-family: 'Roboto Mono', monospace;
            color: #000; border: 1px solid #ccc; line-height: 1.4;
        }
        .inv-header { display: flex; justify-content: space-between; border-bottom: 2px solid #000; padding-bottom: 20px; margin-bottom: 20px; }
        .inv-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.7rem; }
        .inv-table th { text-align: left; border-bottom: 1px solid #000; }

        .step { display: none; }
        .active { display: block; }
    </style>
</head>
<body>

    <div id="start-modal">
        <div class="modal-box">
            <h2 style="margin-bottom: 20px; font-weight: 900;">WERYFIKACJA SYSTEMOWA</h2>
            <div style="font-size: 0.85rem; margin-bottom: 20px;">
                <label><input type="checkbox" class="start-check"> Akceptuję regulamin sprzedaży Renault 2026</label><br><br>
                <label><input type="checkbox" class="start-check"> Potwierdzam status osoby niekaranej</label><br><br>
                <label><input type="checkbox" class="start-check"> Wyrażam zgodę na przetwarzanie danych w BIK</label>
            </div>
            <button class="btn" onclick="startApp()">URUCHOM KONFIGURATOR</button>
        </div>
    </div>

    <div id="cookie-overlay">
        <div style="text-align: center; width: 80%;">
            <p style="font-size: 0.8rem; margin-bottom: 15px;">Aby odblokować nawigację i proces składania zamówienia, zaakceptuj politykę plików cookies.</p>
            <button class="btn" style="background: var(--r-yellow); color: black; width: auto; padding: 10px 40px;" onclick="unlockNav()">AKCEPTUJĘ WSZYSTKO</button>
        </div>
    </div>

    <header>
        <div style="font-weight: 900; font-size: 1.4rem;">RENAULT</div>
        <div style="font-weight: 700;">TOTAL: <span id="price-h">105 000</span> PLN</div>
    </header>

    <main>
        <section class="preview">
            <img src="https://images.unsplash.com/photo-1595786676378-433f169f14d8?q=80&w=1000" id="car-img" style="width: 80%; transition: 0.5s;">
            <h1 id="car-name" style="font-weight: 900; letter-spacing: -2px; font-size: 3rem;">CAPTUR 2025</h1>
        </section>

        <section class="panel">
            <div id="s1" class="step active">
                <h2 style="margin-bottom: 20px;">LAKIER I PODSTAWA</h2>
                <div class="equip-box" onclick="setColor(0, 'Biel Alpejska', 'grayscale(0)')" style="cursor:pointer">Biel Alpejska (0 PLN)</div>
                <div class="equip-box" onclick="setColor(2500, 'Czerń Etoile', 'brightness(0.3)')" style="cursor:pointer">Czerń Etoile (2 500 PLN)</div>
                <div class="equip-box" onclick="setColor(3000, 'Żółty Miel', 'sepia(1) saturate(5) hue-rotate(10deg)')" style="cursor:pointer">Żółty Miel (3 000 PLN)</div>
            </div>

            <div id="s2" class="step">
                <h2 style="margin-bottom: 20px;">WYPOSAŻENIE (27 OPCJI)</h2>
                <div id="options-container"></div>
            </div>

            <div id="s3" class="step">
                <h2 style="margin-bottom: 20px;">FINAŁ I PŁATNOŚĆ</h2>
                <input type="text" id="blik" placeholder="KOD BLIK (6 CYFR)" class="btn" style="background: white; color: black; border: 2px solid #000; margin-bottom: 20px; text-align: center; font-size: 1.5rem;">
                <button class="btn" onclick="processPayment()">AUTORYZUJ I GENERUJ FAKTURĘ</button>
                <div id="loader" style="display:none; text-align:center; margin-top:20px;">Autoryzacja w banku...</div>
            </div>

            <div id="s4" class="step">
                <div id="invoice-view">
                    <div class="inv-header">
                        <div>
                            <strong>FAKTURA PROFORMA</strong><br>
                            Nr: #RN/2026/CAP/<span id="inv-num"></span>
                        </div>
                        <div style="text-align: right;">
                            <strong>DEALER RENAULT</strong><br>
                            Autoryzowany Punkt Sprzedaży
                        </div>
                    </div>
                    <p>Nabywca: Klient Indywidualny (Weryfikacja Pozytywna)</p>
                    <table class="inv-table">
                        <thead>
                            <tr><th>Pozycja</th><th>Cena</th></tr>
                        </thead>
                        <tbody id="inv-rows"></tbody>
                    </table>
                    <div style="text-align: right; font-weight: 700; font-size: 1.2rem; border-top: 2px solid #000;">
                        SUMA: <span id="inv-total"></span> PLN
                    </div>
                    <div style="margin-top: 30px; font-size: 0.6rem;">
                        Dokument wygenerowany systemowo. Prosimy o okazanie niniejszej faktury u dealera w celu sfinalizowania odbioru pojazdu Renault Captur 2025.
                    </div>
                </div>
                <button class="btn" style="margin-top: 20px;" onclick="window.print()">POBIERZ / DRUKUJ FAKTURĘ</button>
            </div>

            <div id="nav" style="margin-top: 40px; display: flex; gap: 10px; position: relative;">
                <button class="btn" style="background: #ccc; color: black;" onclick="nav(-1)">WSTECZ</button>
                <div class="nav-lock-container">
                    <div id="lock" class="lock-shield"></div>
                    <button id="next-btn" class="btn" onclick="nav(1)">DALEJ</button>
                </div>
            </div>
        </section>
    </main>

    <script>
        let step = 1;
        let base = 105000;
        let extPrice = 0;
        let selectedOptions = [];
        let colorName = "Biel Alpejska";
        let navLocked = true;

        const allOptions = [
            "Aktywny system nagłego hamowania", "Kamera 360", "Czujnik martwego pola", "Easy Park Assist", 
            "System kontroli pasów", "Tempomat adaptacyjny", "Rozpoznawanie znaków", "Full LED Pure Vision",
            "Ekran OpenR 10\"", "Audio Harman Kardon", "Indukcja tel.", "Zestaw zegarów 10\"", 
            "Android Auto Wireless", "Podgrzewane fotele", "Podgrzewana kierownica", "Klimatronic 2-strefy",
            "Dach panoramiczny", "Tapicerka Alcantara", "Ambient Light", "Lusterka Fotochromatyczne",
            "Felgi 19\" Diamond", "Relingi dachowe", "Przyciemniane szyby", "Antena płetwa rekina",
            "Hak składany", "Pakiet chrom", "Dywaniki Premium"
        ];

        function startApp() {
            let checks = document.querySelectorAll('.start-check');
            if([...checks].every(c => c.checked)) {
                document.getElementById('start-modal').style.display = 'none';
            } else alert("Musisz zaakceptować wszystkie zgody.");
        }

        function unlockNav() {
            navLocked = false;
            document.getElementById('cookie-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('cookie-overlay').style.display = 'none';
                document.getElementById('lock').style.display = 'none';
            }, 500);
        }

        function renderOptions() {
            const container = document.getElementById('options-container');
            allOptions.forEach((opt, i) => {
                let p = (i % 3 === 0) ? 0 : (i * 250); // Przykładowe ceny
                container.innerHTML += `
                    <div class="item">
                        <input type="checkbox" onchange="toggleOpt('${opt}', ${p}, this)">
                        ${opt} (+${p} PLN)
                    </div>
                `;
            });
        }

        function toggleOpt(name, p, el) {
            if(el.checked) {
                extPrice += p;
                selectedOptions.push({name, p});
            } else {
                extPrice -= p;
                selectedOptions = selectedOptions.filter(o => o.name !== name);
            }
            updatePrice();
        }

        function setColor(p, name, filter) {
            base = 105000 + p;
            colorName = name;
            document.getElementById('car-img').style.filter = filter;
            updatePrice();
        }

        function updatePrice() {
            let total = base + extPrice;
            document.getElementById('price-h').innerText = total.toLocaleString();
        }

        function nav(dir) {
            if(navLocked && dir > 0) return;
            document.getElementById(`s${step}`).classList.remove('active');
            step += dir;
            document.getElementById(`s${step}`).classList.add('active');
        }

        function processPayment() {
            let code = document.getElementById('blik').value;
            if(code.length !== 6) return alert("Błędny kod BLIK");
            
            document.getElementById('loader').style.display = 'block';
            setTimeout(() => {
                document.getElementById('loader').innerText = "Płatność zautoryzowana!";
                setTimeout(() => {
                    generateInvoice();
                    nav(1);
                    document.getElementById('nav').style.display = 'none';
                }, 1000);
            }, 2000);
        }

        function generateInvoice() {
            document.getElementById('inv-num').innerText = Math.floor(Math.random()*90000) + 10000;
            const table = document.getElementById('inv-rows');
            table.innerHTML = `<tr><td>Renault Captur 2025 (Baza)</td><td>105 000 PLN</td></tr>`;
            table.innerHTML += `<tr><td>Lakier: ${colorName}</td><td>Wliczone</td></tr>`;
            selectedOptions.forEach(o => {
                table.innerHTML += `<tr><td>${o.name}</td><td>${o.p} PLN</td></tr>`;
            });
            document.getElementById('inv-total').innerText = (base + extPrice).toLocaleString();
        }

        renderOptions();
    </script>
</body>
</html>
